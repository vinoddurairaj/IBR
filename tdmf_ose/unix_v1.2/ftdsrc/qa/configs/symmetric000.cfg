#===============================================================
# qds test configuration file, for testing a configuration in
# which each of two hosts acts as both a primary and a secondary.
# This is logical group 0.
#===============================================================
#
STATINTERVAL:		1

#
# System Definitions:
#
SYSTEM-TAG:		ULTRA2-PRIMARY		PRIMARY
  HOST:			  ultra2
  HOSTID:		  0x80825e93
  IP:			  208.206.246.9
  WRITELOG-EXTENSION:	  /dev/rdsk/c0t1d0s3
  WRITELOG-EXTENSION:	  /dev/rdsk/c0t1d0s4
  WRITELOG-EXTENSION:	  /dev/rdsk/c1t1d0s3
  WRITELOG-EXTENSION:	  /dev/rdsk/c1t1d0s4

SYSTEM-TAG:		SAFEDATA-B-SECONDARY	SECONDARY
  HOST:			  safedata-b
  HOSTID:		  0x807a98ab
  IP:			  208.206.246.5

#
# Partition Map for Ultra2				# Partition Map for safedata-b
#
# Partition        Size					# Partition        Size
#
# c0t0d0s0	2048960		/			# c0t1d0s0      1018496		pool
# c0t0d0s1	 262960		swap			# c0t1d0s1      1018496		pool
# c0t0d0s2	4154160		--			# c0t1d0s2      2103264
# c0t0d0s7	1842240		/export/ultra2		# c0t1d0s3        66272		qds1 writelog
#
# c0t1d0s0	1017072		qds0			# c0t2d0s0      1019088		pool
# c0t1d0s1	1018080		qds0 mirror		# c0t2d0s1      1019088		pool
# c0t1d0s2	4195296					# c0t2d0s2      4195296
# c0t1d0s3	1018080		pool			# c0t2d0s3      1019088		pool
# c0t1d0s4	1018080		pool			# c0t2d0s4      1019088		pool
# c0t1d0s5	 122976		qds1 writelog		# c0t2d0s5       117936		qds0 writelog
#							# c0t2d0s6      4194288
# c0t2d0s2	4154160
#							# c0t3d0s0      1784160		/
# c1t0d0s2	4195296					# c0t3d0s1       263088		swap
# c1t0d0s3	   2016					# c0t3d0s2      2052288
# c1t0d0s4	4193280					# c0t3d0s7         5040
#
# c1t1d0s0	1017072		qds1			# c2t0d0s0      1020756		qds1 mirror
# c1t1d0s1	1018080		qds1 mirror		# c2t0d0s1      1020756		pool
# c1t1d0s2	4195296					# c2t0d0s2      8393820
# c1t1d0s3	1018080		pool			# c2t0d0s3      1020756		pool
# c1t1d0s4	1018080		pool			# c2t0d0s4      1020756		pool
# c1t1d0s5	 122976		qds0 writelog		# c2t0d0s5      1020756		pool
# c1t1d0s6	4194288					# c2t0d0s6      1020756		pool
#							# c2t0d0s7      2267175
#
#							# c2t1d0s0      1018080		qds0
#							# c2t1d0s1      1018080		qds1
#							# c2t1d0s2      4195296
#							# c2t1d0s3      1018080		qds0 mirror
#							# c2t1d0s4      1018080
#							# c2t1d0s5       121968		pool

#
# Device Definitions
#
PROFILE:		1
  REMARK:		First qds device, primary is ultra2, secondary is safedata-b
  PRIMARY:		ULTRA2-PRIMARY
  DATASTAR-DEVICE:	  /dev/rdsk/qds0
  DATADISK:		  /dev/rdsk/c0t1d0s0
  WRITELOG:		  /dev/rdsk/c1t1d0s5
  SECONDARY:		SAFEDATA-B-SECONDARY
  MIRROR-DISK:		  /dev/rdsk/c2t1d0s3
#
PROFILE:		2
  REMARK:		Second qds device, primary is ultra2, secondary is safedata-b
  PRIMARY:		ULTRA2-PRIMARY
  DATASTAR-DEVICE:	  /dev/rdsk/qds1
  DATADISK:		  /dev/rdsk/c1t1d0s0
  WRITELOG:		  /dev/rdsk/c0t1d0s5
  SECONDARY:		SAFEDATA-B-SECONDARY
  MIRROR-DISK:		  /dev/rdsk/c2t0d0s0

# Throttles
#

# Throttle the applications if writelog threatens to overflow
#
THROTTLE	-		-	    pctwl < 10
    ACTIONLIST
	ACTION:	    set writedelay 0
	ACTION:	    do remwl
    ENDACTIONLIST

THROTTLE	-		-	    pctwl T>= 80
    ACTIONLIST
	ACTION:	    do console %%QDSDEV%%: Writelog consumption reached %%PCTWL%%%. Attempting to chain in new writelog.
	ACTION:	    do addwl
	ACTION:	    do console %%QDSDEV%%: Writelog consumption %%PCTWL%%% after writelog chaining attempt.
    ENDACTIONLIST

THROTTLE	-		-	    pctwl T>= 80
    ACTIONLIST
	ACTION:	    incr writedelay 5000
	ACTION:     set sleep 0
	ACTION:	    do console %%QDSDEV%%: Writelog chaining attempt failed. Slowing writes to this device.
	ACTION:	    do exec /home/dave/bin/wally %%QDSDEV%%: Writelog chaining attempt failed. Slowing writes to this device.
    ENDACTIONLIST

THROTTLE	-		-	    pctwl > 85
    ACTIONLIST
	ACTION:	    incr writedelay 2500
	ACTION:     set sleep 0
	ACTION:	    do console %%QDSDEV%%:  Writelog utilization %%PCTWL%%%. Slowing writes to this device.
    ENDACTIONLIST

# -- End of qds Configuration File:  /etc/opt/qds/dsgrp000.cfg
